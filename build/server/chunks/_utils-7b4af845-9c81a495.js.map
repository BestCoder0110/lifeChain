{"version":3,"file":"_utils-7b4af845-9c81a495.js","sources":["../../../.svelte-kit/adapter-node/_app/immutable/chunks/_utils-7b4af845.js"],"sourcesContent":["import { serialize } from \"cookie\";\nimport dotenv from \"dotenv\";\nimport Iron from \"@hapi/iron\";\ndotenv.config();\nconst SESSION_NAME = \"session\";\nconst SESSION_LENGTH_MS = Number.parseInt(process.env[\"SESSION_LENGTH_MS\"]);\nconst MAGIC_SECRET_KEY = process.env[\"MAGIC_SECRET_KEY\"];\nconst ENCRYPTION_SECRET = process.env[\"ENCRYPTION_SECRET\"];\nasync function encrypt(data) {\n  return data && Iron.seal(data, ENCRYPTION_SECRET, Iron.defaults);\n}\nasync function decrypt(data) {\n  return data && Iron.unseal(data, ENCRYPTION_SECRET, Iron.defaults);\n}\nasync function createSessionCookie(data) {\n  const session = await encrypt(data);\n  return serialize(SESSION_NAME, session, {\n    maxAge: SESSION_LENGTH_MS / 1e3,\n    expires: new Date(Date.now() + SESSION_LENGTH_MS),\n    httpOnly: true,\n    secure: process.env[\"NODE_ENV\"] === \"production\",\n    path: \"/\",\n    sameSite: \"lax\"\n  });\n}\nasync function getSession(cookie) {\n  return await decrypt(cookie);\n}\nfunction removeSessionCookie() {\n  return serialize(SESSION_NAME, \"\", {\n    maxAge: -1,\n    path: \"/\"\n  });\n}\nexport {\n  MAGIC_SECRET_KEY as M,\n  SESSION_NAME as S,\n  createSessionCookie as c,\n  getSession as g,\n  removeSessionCookie as r\n};\n"],"names":[],"mappings":";;;;AAGA,MAAM,CAAC,MAAM,EAAE,CAAC;AACX,MAAC,YAAY,GAAG,UAAU;AAC/B,MAAM,iBAAiB,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC,CAAC;AACvE,MAAC,gBAAgB,GAAG,OAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE;AACzD,MAAM,iBAAiB,GAAG,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;AAC3D,eAAe,OAAO,CAAC,IAAI,EAAE;AAC7B,EAAE,OAAO,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,iBAAiB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AACnE,CAAC;AACD,eAAe,OAAO,CAAC,IAAI,EAAE;AAC7B,EAAE,OAAO,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,iBAAiB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;AACrE,CAAC;AACD,eAAe,mBAAmB,CAAC,IAAI,EAAE;AACzC,EAAE,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC;AACtC,EAAE,OAAO,SAAS,CAAC,YAAY,EAAE,OAAO,EAAE;AAC1C,IAAI,MAAM,EAAE,iBAAiB,GAAG,GAAG;AACnC,IAAI,OAAO,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,iBAAiB,CAAC;AACrD,IAAI,QAAQ,EAAE,IAAI;AAClB,IAAI,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,YAAY;AACpD,IAAI,IAAI,EAAE,GAAG;AACb,IAAI,QAAQ,EAAE,KAAK;AACnB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,eAAe,UAAU,CAAC,MAAM,EAAE;AAClC,EAAE,OAAO,MAAM,OAAO,CAAC,MAAM,CAAC,CAAC;AAC/B,CAAC;AACD,SAAS,mBAAmB,GAAG;AAC/B,EAAE,OAAO,SAAS,CAAC,YAAY,EAAE,EAAE,EAAE;AACrC,IAAI,MAAM,EAAE,CAAC,CAAC;AACd,IAAI,IAAI,EAAE,GAAG;AACb,GAAG,CAAC,CAAC;AACL;;;;"}